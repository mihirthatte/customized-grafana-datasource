{"version":3,"sources":["../src/query_ctrl.js"],"names":["QueryCtrl","GenericDatasourceQueryCtrl","$scope","$injector","uiSegmentSrv","scope","target","series","type","condition","groupby_field","segments","valueSegments","metric_array","metricValues_array","target_alias","push","name","console","log","datasource","metricFindColumns","then","transformToSegments","metricFindValues","metricFindTables","rawQuery","param","index","metric","metricValues","templateUrl"],"mappings":"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","file":"query_ctrl.js","sourcesContent":["import {QueryCtrl} from 'app/plugins/sdk';\nimport './css/query-editor.css!'\n\nexport class GenericDatasourceQueryCtrl extends QueryCtrl {\n\n  constructor($scope, $injector, uiSegmentSrv)  {\n    super($scope, $injector);\n\n    this.scope = $scope;\n    this.uiSegmentSrv = uiSegmentSrv;\n    this.target.series = this.target.series||'select table';\n    this.target.type = this.target.type || 'timeserie';\n    this.target.condition = this.target.condition || ' ';\n    this.target.groupby_field = this.target.groupby_field || ' '; \n    this.target.segments = this.target.segments||[];\n    this.target.valueSegments =this.target.valueSegments||[];\n    this.target.metric_array = this.target.metric_array||['Select Metric'];\n    this.target.metricValues_array = this.target.metricValues_array ||['Select Metric Value'];\n    this.target.target_alias = this.target.target_alias||\"\";\n    \n  }\n\t\n  addSegments(){\n\t\tthis.target.segments.push({name:'Select Metric'});\n\t\tconsole.log(this.target.segments);\n\t}\n\n  addValueSegments(){\n                this.target.valueSegments.push({name:'Select Metric Value'});\n                console.log(this.target.valueSegments);\n        }\n  getColumns() {\n\tconsole.log(\"I am in get Columns\");\n\tconsole.log(this.target);\n    return this.datasource.metricFindColumns(this.target)\n      .then(this.uiSegmentSrv.transformToSegments(false));\n  }\n\n  getMetricValues() {\n        console.log(\"I am in get Metric Values\");\n        console.log(this.target);\n    return this.datasource.metricFindValues(this.target)\n      .then(this.uiSegmentSrv.transformToSegments(false));\n       }\n\n\n\n getTableNames() {\n        console.log(\"I am in get Table Names\");\n        console.log(this.target);\n    return this.datasource.metricFindTables(this.target)\n      .then(this.uiSegmentSrv.transformToSegments(false));\n        }\n\t\n\n\n  toggleEditorMode() {\n    this.target.rawQuery = !this.target.rawQuery;\n  }\n\n  onChangeInternal(param, index) {\n    console.log(index);\n\t\n    if(param == 'table'){\n\tthis.target.metric_array = [];\n        this.target.metricValues_array = [];\n    }\n    \n    else if (param == 'metric'){\n    \tif (this.target.metric != 'select metric'){\n\t\tif(this.target.metric_array[index]){\n\t\t\tthis.target.metric_array[index] = this.target.metric;\n\t\t}\n\t\telse {\n    \t\t\tthis.target.metric_array.push(this.target.metric);\n\t\t}\n    \t}\n    }\n\n   else if(param == 'values'){\n   \tif (this.target.metricValues != 'select metric Value'){\n\t\tif(this.target.metricValues_array[index]){\n\t\t\tthis.target.metricValues_array[index] = this.target.metricValues;\n\t\t}\n\t\telse { \n        \t\tthis.target.metricValues_array.push(this.target.metricValues);\n\t\t}\n    \t}\n   }\n    console.log(this.target);\n    //this.panelCtrl.refresh(); // Asks the panel to refresh data.\n  }\n}\n\nGenericDatasourceQueryCtrl.templateUrl = 'partials/query.editor.html';\n\n"]}